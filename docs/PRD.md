# Real-time Crypto Trading Dashboard - 제품 요구사항 정의서 (PRD)

**문서 버전**: v1.0
**작성일**: 2026-02-25
**프로젝트 상태**: 기획 단계

본 문서는 Real-time Crypto Trading Dashboard의 제품 요구사항을 정의한다. 바이낸스 및 업비트의 퍼블릭 WebSocket API를 브라우저에 직접 연결하여, 서버 중계 비용 없이 초당 수십 건의 실시간 금융 데이터를 60fps로 시각화하는 고성능 프론트엔드 애플리케이션의 전체 스펙을 다룬다. 이 프로젝트는 14년 차 프론트엔드 개발자의 대규모 데이터 스트리밍 처리, 브라우저 렌더링 최적화, WebSocket 생명주기 관리에 대한 압도적 기술력을 증명하기 위한 포트폴리오 프로젝트이다.

## 1. 프로젝트 개요

### 1.1 제품 요약

| 항목 | 내용 |
|------|------|
| 프로젝트명 | Real-time Crypto Trading Dashboard |
| 핵심 비전 | 서버 비용 Zero로 거래소급 실시간 금융 데이터 시각화를 브라우저에서 구현 |
| 핵심 가치 제안 | 퍼블릭 WebSocket 직접 연결 + Canvas 기반 렌더링으로 DOM 병목을 완전 제거하고, 60fps를 보장하는 고성능 트레이딩 대시보드 |
| 대상 사용자 | 암호화폐 트레이더, 기술 포트폴리오 평가자(채용 담당자, 시니어 개발자) |
| 배포 환경 | Vercel (정적 호스팅 + Edge Functions) |

### 1.2 핵심 가치 제안

이 프로젝트가 해결하는 근본적인 기술적 과제는 다음과 같다.

1. **서버 트래픽 비용 Zero**: 거래소 퍼블릭 WebSocket을 브라우저에서 직접 구독하여 백엔드 프록시 서버 없이 실시간 데이터를 수신한다. Supabase는 오직 사용자 설정(레이아웃, 관심 종목) 영속화에만 사용한다.
2. **DOM 병목 완전 제거**: 초당 수십~수백 건의 호가 업데이트를 React DOM으로 렌더링하면 Reflow/Repaint 폭풍이 발생한다. 오더북과 체결 내역을 Canvas 2D Context로 직접 렌더링하여 이 병목을 근본적으로 제거한다.
3. **60fps 보장 렌더링 파이프라인**: `requestAnimationFrame` 기반의 렌더링 루프를 설계하여, 데이터 수신 빈도와 화면 갱신 빈도를 분리(Decoupling)한다. 데이터는 매 tick마다 상태에 반영하되, 렌더링은 프레임 예산(16.67ms) 내에서만 수행한다.
4. **장시간 운용 안정성**: 트레이더는 대시보드를 수 시간 이상 켜놓는다. Typed Array 기반 링 버퍼, WeakRef 패턴, 주기적 GC 힌트 등을 통해 1시간 이상 연속 사용 시에도 메모리 200MB 이하를 유지한다.

## 2. 목표

### 2.1 비즈니스 목표

- 14년 차 프론트엔드 개발자의 기술 포트폴리오로서, 실시간 데이터 처리 및 브라우저 렌더링 최적화 역량을 정량적으로 증명한다.
- 서버 운영 비용 없이 Vercel 무료 티어만으로 운영 가능한 아키텍처를 구현하여, 제로 코스트 실시간 애플리케이션의 가능성을 시연한다.
- GitHub 오픈소스 프로젝트로서 기술 커뮤니티의 관심과 스타를 확보한다.

### 2.2 사용자 목표

- **트레이더**: 별도 설치 없이 브라우저에서 바로 접근 가능한 실시간 시세 대시보드를 사용하여, 여러 종목의 가격 변동, 호가 깊이, 체결 흐름을 한 화면에서 모니터링한다.
- **포트폴리오 평가자**: 코드베이스와 실제 동작하는 데모를 통해 지원자의 WebSocket 스트리밍 처리, 렌더링 최적화, 상태 관리 설계 역량을 평가한다.

### 2.3 비목표 (Non-goals)

- 실제 매매 주문 기능 (Private API 연동은 범위 밖)
- 백엔드 서버를 통한 데이터 중계 또는 집계
- 모바일 네이티브 앱 개발 (반응형 웹 대응은 포함하되, 네이티브 앱은 비목표)
- 복잡한 기술적 분석 지표 (RSI, MACD 등의 보조 지표는 향후 확장 범위)
- 다국어 지원 (영문 단일 언어로 제공)

## 3. 사용자 페르소나

### 3.1 페르소나 A: 암호화폐 데이 트레이더 ("민수")

| 항목 | 내용 |
|------|------|
| 이름 | 민수 |
| 나이 | 32세 |
| 직업 | 전업 암호화폐 트레이더 |
| 기술 수준 | 중급 (웹 앱 사용에 익숙, 개발 경험 없음) |
| 사용 환경 | 듀얼 모니터, Chrome 최신 버전, 유선 인터넷 |
| 핵심 니즈 | 여러 종목의 실시간 호가, 체결가, 캔들 차트를 한 화면에서 동시에 모니터링 |
| 불만 사항 | 기존 거래소 웹 페이지가 여러 탭을 열면 느려지고, 원하는 레이아웃으로 커스텀이 불가능함 |
| 사용 시나리오 | 아침에 대시보드를 열고, 관심 종목 5~8개를 위젯으로 배치한 뒤, 하루 종일 모니터링하며 별도 거래소 앱에서 주문을 실행 |
| 성공 기준 | 4시간 이상 연속 사용 시에도 프레임 드롭 없이 안정적으로 동작할 것 |

### 3.2 페르소나 B: 기술 포트폴리오 평가자 ("영진")

| 항목 | 내용 |
|------|------|
| 이름 | 영진 |
| 나이 | 38세 |
| 직업 | 테크 기업 프론트엔드 팀 리드 / 채용 담당 |
| 기술 수준 | 상급 (React, 성능 최적화, 시스템 설계에 깊은 이해) |
| 사용 환경 | MacBook Pro, Chrome DevTools 상시 사용 |
| 핵심 니즈 | 지원자의 실시간 데이터 처리 역량, 렌더링 최적화 설계 품질, 코드 아키텍처를 평가 |
| 평가 포인트 | Performance 탭에서 프레임 드롭 여부 확인, Memory 탭에서 메모리 누수 점검, Network 탭에서 WebSocket 프레임 확인, 코드 리뷰 |
| 사용 시나리오 | 데모 URL 접속 → 30초간 인터랙션 → DevTools로 성능 프로파일링 → GitHub 코드 리뷰 → 기술 면접 질문 도출 |
| 성공 기준 | DevTools Performance 프로파일링에서 Jank(긴 프레임)가 관측되지 않을 것, 코드에서 명확한 아키텍처 의도가 읽힐 것 |

### 3.3 역할 기반 접근 제어

| 역할 | 설명 | 접근 범위 |
|------|------|-----------|
| 비로그인 사용자 | 소셜 로그인 없이 접근한 사용자 | 모든 실시간 데이터 조회, 차트, 호가창, 체결 내역 열람 가능. 레이아웃과 관심 종목은 localStorage에 임시 저장 |
| 로그인 사용자 | Google 또는 GitHub 소셜 로그인 완료 사용자 | 비로그인 사용자의 모든 기능 + Supabase를 통한 레이아웃/관심 종목 영구 저장 및 복원, 다중 기기 동기화 |

## 4. 핵심 기능 명세

### 4.1 실시간 캔들스틱 차트

**우선순위**: P0 (필수)

| 항목 | 상세 |
|------|------|
| 라이브러리 | TradingView Lightweight Charts (Apache 2.0) |
| 데이터 소스 | Binance WebSocket `kline` 스트림 (wss://stream.binance.com:9443) |
| 지원 타임프레임 | 1m, 5m, 15m, 1h, 4h, 1d |
| 초기 로딩 | REST API로 과거 500개 캔들을 fetch한 뒤 WebSocket 실시간 업데이트로 전환 |
| 렌더링 방식 | Lightweight Charts 내부의 Canvas 렌더링 활용 (DOM 요소 최소화) |
| 인터랙션 | 줌/패닝, 십자선(Crosshair), 타임프레임 전환, 심볼 변경 |
| 데이터 관리 | 차트 내 캔들 데이터는 최대 2,000개로 제한하며, 오래된 데이터는 FIFO 방식으로 폐기 |

**기술 구현 세부사항**:
- WebSocket에서 수신한 `kline` 이벤트의 `k.x` (캔들 마감 여부) 플래그를 확인하여, 미완성 캔들은 `update()`로, 완성된 캔들은 `addData()`로 처리한다.
- 타임프레임 전환 시 기존 WebSocket 구독을 해제하고 새 스트림으로 재구독하며, REST API로 해당 타임프레임의 히스토리 데이터를 다시 fetch한다.
- 차트 인스턴스는 위젯 unmount 시 반드시 `remove()`를 호출하여 내부 리소스를 해제한다.

### 4.2 실시간 오더북 (호가창)

**우선순위**: P0 (필수)

| 항목 | 상세 |
|------|------|
| 데이터 소스 | Binance WebSocket `depth` 스트림 (diff depth stream, 100ms 주기) |
| 초기 스냅샷 | REST API `/api/v3/depth?limit=1000`으로 초기 스냅샷 수신 후, diff 이벤트를 순차 적용 |
| 렌더링 방식 | **Canvas 2D Context 커스텀 렌더링** (React DOM 완전 우회) |
| 표시 depth | 매수/매도 각 25단계 (설정으로 10/25/50 변경 가능) |
| 시각 요소 | 가격, 수량, 누적 수량, 깊이 히트맵 바(Volume depth bar) |
| 갱신 전략 | `requestAnimationFrame` 루프에서 dirty flag 확인 후 Canvas redraw |

**기술 구현 세부사항**:
- 오더북 상태는 매수(`bids`)와 매도(`asks`)를 각각 정렬된 배열(또는 Red-Black Tree 구조의 SortedMap)로 유지한다. Binance diff 이벤트에서 수량이 `0`인 가격 레벨은 삭제, 그 외는 upsert한다.
- `lastUpdateId`를 추적하여 스냅샷과 diff 스트림 간의 시퀀스 갭이 발생하면 스냅샷을 재요청한다.
- Canvas 렌더링 루프는 독립적인 `requestAnimationFrame` 콜백으로 동작하며, 데이터 변경이 없으면(`isDirty === false`) draw를 스킵하여 불필요한 렌더링을 방지한다.
- 가격 변동 시 해당 행에 0.3초간 하이라이트 애니메이션을 Canvas alpha 블렌딩으로 구현한다.
- Canvas 해상도는 `window.devicePixelRatio`를 반영하여 Retina 디스플레이에서도 선명하게 렌더링한다.

### 4.3 실시간 체결 내역 (Trade feed)

**우선순위**: P0 (필수)

| 항목 | 상세 |
|------|------|
| 데이터 소스 | Binance WebSocket `trade` 스트림 |
| 렌더링 방식 | Canvas 2D Context 커스텀 렌더링 (스크롤링 리스트) |
| 표시 항목 | 체결 시간, 가격, 수량, 매수/매도 구분 (색상 코딩) |
| 데이터 보관 | 링 버퍼(Ring Buffer) 기반 최대 200건 유지 |
| 갱신 전략 | 새 체결 발생 시 dirty flag 설정 → 다음 rAF에서 Canvas redraw |

**기술 구현 세부사항**:
- 체결 데이터는 `Float64Array` 기반 링 버퍼에 저장하여 GC 압박을 최소화한다. 각 체결 건은 `[timestamp, price, quantity, isBuyerMaker]` 4개 필드로 고정 크기 슬롯에 기록한다.
- 새 체결이 추가되면 가장 오래된 항목을 자연스럽게 덮어쓰며, 별도의 배열 조작(shift/splice) 없이 O(1)로 동작한다.
- 매수 체결은 녹색, 매도 체결은 빨간색으로 구분하여 트레이더가 시장 방향성을 직관적으로 파악할 수 있게 한다.

### 4.4 드래그 앤 드롭 대시보드 그리드

**우선순위**: P0 (필수)

| 항목 | 상세 |
|------|------|
| 라이브러리 | React Grid Layout (`react-grid-layout`) |
| 그리드 단위 | 12컬럼 기반, 행 높이 자동 계산 |
| 위젯 종류 | 캔들스틱 차트, 오더북, 체결 내역, 관심 종목 목록, 심볼 선택기 |
| 조작 기능 | 드래그 이동, 리사이즈, 위젯 추가/제거, 레이아웃 리셋 |
| 레이아웃 저장 | 비로그인: localStorage, 로그인: Supabase DB |
| 반응형 지원 | 브레이크포인트별(lg: 1200px, md: 996px, sm: 768px) 레이아웃 자동 전환 |

**기술 구현 세부사항**:
- 레이아웃 변경 시 `onLayoutChange` 콜백에서 debounce(500ms)를 적용하여 과도한 저장 요청을 방지한다.
- 위젯 리사이즈 시 내부 Canvas/Chart 인스턴스의 `resize()` 메서드를 `ResizeObserver`로 트리거하여 렌더링 영역을 동기화한다.
- 각 위젯은 `React.memo`로 감싸고, Zustand selector를 통해 해당 위젯에 필요한 상태만 구독하여 불필요한 리렌더를 원천 차단한다.

### 4.5 관심 종목 (Watchlist)

**우선순위**: P1 (중요)

| 항목 | 상세 |
|------|------|
| 기능 | 종목 검색 및 추가/제거, 실시간 가격 표시, 24시간 변동률 |
| 데이터 소스 | Binance WebSocket `miniTicker` 스트림 (구독 종목별) |
| 저장 | 비로그인: localStorage, 로그인: Supabase DB |
| 최대 종목 수 | 20개 |
| 인터랙션 | 종목 클릭 시 차트/오더북/체결 내역 위젯의 심볼을 해당 종목으로 전환 |

### 4.6 사용자 인증

**우선순위**: P1 (중요)

| 항목 | 상세 |
|------|------|
| 인증 제공자 | Supabase Auth (Google OAuth, GitHub OAuth) |
| 비로그인 지원 | 모든 핵심 기능(차트, 호가창, 체결 내역, 위젯 그리드)은 로그인 없이 사용 가능 |
| 로그인 혜택 | 레이아웃 및 관심 종목의 클라우드 저장/복원, 다중 기기 동기화 |
| 세션 관리 | Supabase JWT 토큰 기반, 자동 갱신 |
| 로그인 UI | 우측 상단 프로필 아이콘 → 드롭다운 → 소셜 로그인 버튼 |

## 5. 성능 목표

### 5.1 렌더링 성능

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| 프레임 레이트 | 60fps 유지 (최소 55fps, Jank 프레임 < 1%) | Chrome DevTools Performance 탭, `PerformanceObserver` long task 모니터링 |
| Long Task | 50ms 이상의 Long Task 발생률 < 0.5% | `PerformanceObserver`로 long task 감지 및 리포팅 |
| Canvas redraw 시간 | 오더북 단일 프레임 렌더링 < 4ms | `performance.mark()` / `performance.measure()`로 계측 |
| React 리렌더 | 위젯 외부 상태 변경 시 해당 위젯 리렌더 Zero | React DevTools Profiler, `why-did-you-render` 라이브러리 |

### 5.2 메모리 관리

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| 초기 로딩 후 메모리 | < 80MB (JS Heap) | Chrome DevTools Memory 탭 |
| 1시간 연속 사용 후 메모리 | < 200MB (JS Heap) | 자동화 테스트(Puppeteer)로 1시간 구동 후 힙 스냅샷 |
| 메모리 누수 | Heap 증가율 < 2MB/hr (정상 상태 도달 후) | 힙 스냅샷 비교(Allocation Timeline) |
| Detached DOM Nodes | 0개 | 힙 스냅샷에서 Detached DOM 검색 |

### 5.3 네트워크 및 연결

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| WebSocket 재연결 시간 | < 3초 (지수 백오프, 최대 30초) | 네트워크 단절 시뮬레이션 후 재연결 시간 측정 |
| 초기 데이터 로딩 | REST 히스토리 fetch + WebSocket 연결 < 2초 | Navigation Timing API |
| WebSocket 메시지 처리율 | 초당 500건 이상 처리 가능 | 부하 테스트(mock WebSocket 서버) |

### 5.4 초기 로딩 성능

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| LCP (Largest Contentful Paint) | < 2.0초 | Lighthouse, Web Vitals |
| FCP (First Contentful Paint) | < 1.0초 | Lighthouse, Web Vitals |
| TTI (Time to Interactive) | < 3.0초 | Lighthouse |
| JS 번들 크기 (gzip) | < 150KB (초기 로드 번들) | `next build` 분석, `@next/bundle-analyzer` |
| CLS (Cumulative Layout Shift) | < 0.1 | Lighthouse, Web Vitals |

## 6. 기술 스택 요약

### 6.1 프론트엔드

| 기술 | 용도 | 선택 근거 |
|------|------|-----------|
| Next.js 14+ (App Router) | 프레임워크 | SSG 기반 초기 로딩 최적화, 이미지 최적화, 라우팅 |
| TypeScript | 언어 | 대규모 코드베이스에서의 타입 안전성, WebSocket 메시지 타입 정의 |
| Zustand | 상태 관리 | selector 기반 구독으로 불필요한 리렌더 최소화, 보일러플레이트 최소 |
| TradingView Lightweight Charts | 캔들스틱 차트 | Apache 2.0 무료 라이선스, Canvas 기반 고성능 렌더링, 금융 차트 전문 |
| Canvas API | 오더북/체결 렌더링 | DOM 완전 우회로 Reflow/Repaint 비용 Zero |
| React Grid Layout | 대시보드 그리드 | 드래그/리사이즈/반응형 지원, React 생태계 호환 |

### 6.2 백엔드 및 인프라

| 기술 | 용도 | 선택 근거 |
|------|------|-----------|
| Supabase | 인증 + 데이터 영속화 | Google/GitHub OAuth 내장, PostgreSQL 기반, 무료 티어 충분 |
| Vercel | 배포 | Next.js 최적 배포 환경, 글로벌 CDN, 무료 티어 |

### 6.3 개발 도구

| 기술 | 용도 |
|------|------|
| ESLint + Prettier | 코드 품질 및 포맷팅 |
| Vitest | 단위 테스트 |
| Playwright | E2E 테스트 및 성능 자동화 테스트 |
| Husky + lint-staged | Git 훅 기반 코드 품질 게이트 |

## 7. 데이터 파이프라인

### 7.1 WebSocket 데이터 흐름 아키텍처

```
[Binance WebSocket API]
        │
        ▼
┌─────────────────────────────────┐
│  WebSocket Manager (Singleton)  │
│  - 연결/재연결/구독 관리          │
│  - 메시지 역직렬화(JSON.parse)    │
│  - 메시지 라우팅                  │
└──────────┬──────────────────────┘
           │ 메시지 타입별 분기
           ├──────────────────┬──────────────────┐
           ▼                  ▼                  ▼
   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
   │ Kline Worker │  │ Depth Worker │  │ Trade Worker │
   │ (Throttled)  │  │ (Buffered)   │  │ (Immediate)  │
   └──────┬───────┘  └──────┬───────┘  └──────┬───────┘
          │                  │                  │
          ▼                  ▼                  ▼
   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
   │ Zustand      │  │ Zustand      │  │ Zustand      │
   │ Kline Store  │  │ Depth Store  │  │ Trade Store  │
   └──────┬───────┘  └──────┬───────┘  └──────┬───────┘
          │                  │                  │
          ▼                  ▼                  ▼
   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
   │ Lightweight  │  │ Canvas 2D   │  │ Canvas 2D   │
   │ Charts       │  │ OrderBook   │  │ TradeFeed   │
   │ (내부 Canvas) │  │ Renderer    │  │ Renderer    │
   └──────────────┘  └──────────────┘  └──────────────┘
```

### 7.2 데이터 흐름 상세

**Phase 1 - 연결 및 초기화**:
1. 컴포넌트 마운트 시 `WebSocketManager.subscribe(streams[])` 호출
2. Combined Stream URL 생성: `wss://stream.binance.com:9443/stream?streams=btcusdt@kline_1m/btcusdt@depth@100ms/btcusdt@trade`
3. 병렬로 REST API에서 히스토리 데이터(캔들 500개, 오더북 스냅샷) fetch
4. WebSocket `onopen` 확인 후 실시간 업데이트 수신 시작

**Phase 2 - 메시지 처리**:
1. WebSocket `onmessage`에서 `JSON.parse` 후 `stream` 필드로 메시지 타입 분기
2. 각 데이터 타입별 처리 전략:
   - **Kline**: 현재 캔들 업데이트 → Zustand store 갱신 → Lightweight Charts `update()` 호출
   - **Depth**: diff 이벤트를 내부 오더북 자료구조에 적용 → dirty flag 설정 → rAF에서 Canvas redraw
   - **Trade**: 링 버퍼에 append → dirty flag 설정 → rAF에서 Canvas redraw

**Phase 3 - 렌더링 분리**:
- 데이터 수신과 렌더링은 완전히 분리된다. 데이터는 매 WebSocket 메시지마다 즉시 상태에 반영하지만, Canvas 렌더링은 `requestAnimationFrame` 콜백 안에서만 수행한다.
- 한 프레임(16.67ms) 동안 여러 건의 데이터 업데이트가 발생해도 Canvas redraw는 1회만 실행된다 (자연스러운 배치 처리).

### 7.3 WebSocket 연결 생명주기

```
[IDLE] ──connect()──▶ [CONNECTING]
                           │
                     onopen │
                           ▼
                      [CONNECTED] ◀──────────────┐
                           │                      │
                    onclose/onerror               │ reconnect
                           │                      │ (지수 백오프)
                           ▼                      │
                    [RECONNECTING] ───────────────┘
                           │
                    max retries 초과
                           ▼
                       [FAILED]
```

- **지수 백오프 전략**: 1초 → 2초 → 4초 → 8초 → 16초 → 30초(최대)
- **하트비트 감지**: 30초간 메시지 미수신 시 연결이 끊어진 것으로 간주하고 재연결 시도
- **Page Visibility API 연동**: 탭이 비활성화되면 WebSocket을 유지하되 렌더링을 중단하여 CPU 절약. 탭 활성화 시 최신 스냅샷을 다시 fetch하여 데이터 정합성 확보
- **구독 관리**: 심볼 변경 시 기존 스트림 unsubscribe → 새 스트림 subscribe (WebSocket 연결 자체는 유지)

### 7.4 데이터 무결성 보장

- **오더북 시퀀스 관리**: Binance `depth` 스트림의 `lastUpdateId`를 추적하여, 스냅샷의 `lastUpdateId` 이하의 diff 이벤트는 폐기하고, 시퀀스 갭 발생 시 스냅샷을 재요청한다.
- **캔들 마감 처리**: `kline` 이벤트의 `k.x === true` 시점에 캔들을 확정(finalize)하고, 후속 이벤트는 새 캔들로 처리한다.
- **타임스탬프 정렬**: 네트워크 지연으로 이벤트 순서가 뒤바뀔 수 있으므로, 오더북 diff는 `E`(event time) 기준으로 순서를 보장한다.

## 8. 사용자 경험

### 8.1 진입점

- **메인 URL 접속**: 기본 대시보드 레이아웃(BTC/USDT 차트 + 오더북 + 체결 내역)이 즉시 로딩된다.
- **심볼 파라미터**: URL 쿼리 파라미터(`?symbol=ETHUSDT`)로 특정 종목 대시보드에 직접 진입 가능하다.
- **저장된 레이아웃 복원**: 로그인 사용자는 마지막으로 저장한 레이아웃이 자동 복원된다.

### 8.2 핵심 경험 흐름

1. 사용자가 대시보드에 접속하면 기본 레이아웃(차트, 오더북, 체결 내역, 관심 종목)이 로딩된다.
2. 실시간 데이터가 즉시 스트리밍되기 시작하며, 캔들 차트가 업데이트되고 오더북과 체결 내역이 실시간으로 갱신된다.
3. 사용자는 심볼 선택기를 통해 관심 종목을 변경할 수 있으며, 변경 즉시 모든 위젯이 해당 종목 데이터로 전환된다.
4. 위젯을 드래그하여 위치를 변경하거나, 리사이즈 핸들로 크기를 조절하여 자신만의 레이아웃을 구성한다.
5. 관심 종목 위젯에서 다른 종목을 클릭하면 차트와 오더북이 해당 종목으로 전환된다.

### 8.3 고급 기능

- **위젯 추가/제거**: 헤더 툴바의 "+" 버튼으로 새 위젯을 추가하고, 위젯 우측 상단 "x" 버튼으로 제거한다.
- **레이아웃 리셋**: 기본 레이아웃으로 복원하는 리셋 버튼을 제공한다.
- **다크/라이트 테마**: 트레이더 선호에 맞춘 다크 모드 기본 제공, 라이트 모드 전환 가능.
- **오더북 깊이 조절**: 10/25/50단계 중 선택 가능.
- **차트 타임프레임 전환**: 1m, 5m, 15m, 1h, 4h, 1d 선택 가능.

### 8.4 UI/UX 핵심 원칙

- **다크 모드 우선**: 금융 트레이딩 도구의 표준인 다크 테마를 기본값으로 설정한다.
- **정보 밀도 최대화**: 제한된 화면에 최대한 많은 정보를 표시하되, 가독성을 해치지 않는 적절한 여백과 폰트 크기를 유지한다.
- **색상 코딩 일관성**: 매수(녹색, #00C087), 매도(빨간색, #F6465D)의 색상 코딩을 모든 위젯에서 일관되게 적용한다.
- **연결 상태 표시**: WebSocket 연결 상태를 상단 바에 아이콘으로 표시한다 (연결됨: 녹색 점, 재연결 중: 노란색 점, 연결 끊김: 빨간색 점).
- **제로 로딩 스피너 원칙**: 초기 로딩 이후에는 스피너 없이 데이터가 자연스럽게 흘러들어오는 경험을 제공한다.

## 9. 내러티브

민수는 오전 9시에 노트북을 열고 브라우저에 즐겨찾기해둔 대시보드 URL을 클릭한다. 1초 만에 어두운 화면 위에 BTC/USDT 캔들 차트가 나타나고, 오른쪽의 오더북에는 매수-매도 호가가 초록과 빨간 막대 그래프와 함께 빠르게 흐르기 시작한다. 아래쪽 체결 내역에서는 방금 체결된 거래들이 순식간에 쌓여간다. 민수는 관심 종목 위젯에서 어젯밤 추가해둔 ETH, SOL, XRP의 실시간 가격 변동률을 한눈에 확인한다. ETH의 변동률이 눈에 띄자 클릭하는 순간, 차트와 오더북이 즉시 ETH/USDT 데이터로 전환된다. 민수는 오더북 위젯을 드래그하여 화면 왼쪽으로 옮기고, 차트 위젯의 크기를 넓혀 더 넓은 시야로 캔들 패턴을 분석한다. 듀얼 모니터 한쪽에서 이 대시보드를 띄워놓고, 다른 모니터에서는 거래소에서 직접 주문을 넣으며, 4시간이 지나도 단 한 번의 버벅임도 느끼지 못한 채 트레이딩에 집중한다.

## 10. 성공 지표

### 10.1 사용자 중심 지표

| 지표 | 목표 | 설명 |
|------|------|------|
| 세션 지속 시간 | 평균 30분 이상 | 실시간 모니터링 도구로서 장시간 사용을 유도 |
| 재방문율 (7일) | 40% 이상 | 트레이딩 루틴에 대시보드가 포함되는지 측정 |
| 레이아웃 커스텀 비율 | 사용자 60% 이상이 기본 레이아웃을 변경 | 드래그 앤 드롭 기능의 발견성과 유용성 측정 |
| 관심 종목 추가율 | 사용자 50% 이상이 1개 이상 종목 추가 | 개인화 기능 활용도 측정 |

### 10.2 비즈니스 지표 (포트폴리오 목적)

| 지표 | 목표 | 설명 |
|------|------|------|
| GitHub Stars | 6개월 내 100+ | 기술 커뮤니티의 관심도 |
| 데모 사이트 방문자 | 월 500+ UV | 포트폴리오 노출도 |
| 서버 운영 비용 | 월 $0 | Vercel 무료 티어 + Supabase 무료 티어 내 운영 |
| Lighthouse 성능 점수 | 90+ | 프론트엔드 최적화 역량의 객관적 지표 |

### 10.3 기술 지표

| 지표 | 목표 | 설명 |
|------|------|------|
| 프레임 드롭율 | < 1% (55fps 이하 프레임 비율) | 실시간 렌더링 안정성 |
| 메모리 누수 | 힙 증가율 < 2MB/hr | 장시간 운용 안정성 |
| WebSocket 가용률 | > 99% (연결 유지 시간 비율) | 데이터 스트림 안정성 |
| 테스트 커버리지 | > 80% (유틸, 상태 관리 로직) | 코드 품질 |
| 빌드 크기 (gzip) | < 150KB (초기 번들) | 초기 로딩 성능 |

## 11. 기술적 고려사항

### 11.1 통합 지점

| 외부 시스템 | 연동 방식 | 비고 |
|------------|-----------|------|
| Binance WebSocket API | 브라우저 직접 연결 (wss://stream.binance.com:9443) | 퍼블릭 API, 인증 불필요, 연결 당 최대 5개 스트림(Combined Stream으로 다중 구독) |
| Binance REST API | HTTP fetch (https://api.binance.com) | 히스토리 캔들, 오더북 스냅샷 초기 로딩용 |
| Supabase Auth | OAuth 2.0 (Google, GitHub) | 소셜 로그인, JWT 세션 관리 |
| Supabase Database | PostgreSQL + REST API | 사용자 레이아웃, 관심 종목 CRUD |
| Upbit WebSocket API | 브라우저 직접 연결 (Phase 2) | 한국 원화 마켓 지원을 위한 확장 |

### 11.2 데이터 저장 및 개인정보

- **클라이언트 저장**: 비로그인 사용자의 레이아웃 및 관심 종목은 `localStorage`에 JSON으로 저장한다. 용량 제한(5MB)을 고려하여 최대 5개 레이아웃 프리셋까지 저장한다.
- **서버 저장**: 로그인 사용자의 데이터는 Supabase PostgreSQL에 저장한다. RLS(Row Level Security) 정책으로 사용자 본인의 데이터만 접근 가능하도록 보장한다.
- **개인정보**: 수집하는 개인정보는 OAuth 제공자로부터 받는 이메일과 프로필 사진뿐이며, 금융 거래 데이터나 API 키는 일절 수집하지 않는다.
- **CORS**: Binance WebSocket 및 REST API는 퍼블릭으로 CORS 제한이 없으나, Upbit 확장 시 CORS 정책 확인이 필요하다.

### 11.3 확장성 및 성능

- **WebSocket 연결 수 관리**: 브라우저 당 WebSocket 연결 수를 최소화하기 위해 Binance Combined Stream을 활용한다. 단일 WebSocket 연결로 최대 1024개 스트림을 구독할 수 있다.
- **메모리 관리 전략**:
  - 캔들 데이터: 차트 당 최대 2,000개 캔들 유지, FIFO 폐기
  - 오더북: 매수/매도 각 50레벨로 제한
  - 체결 내역: 링 버퍼 200건
  - Typed Array 사용으로 GC 압박 최소화
- **CPU 절약**: `document.hidden === true` 시 Canvas 렌더링 루프를 일시 중단하고 데이터만 버퍼링한다.
- **번들 최적화**: Dynamic import로 차트 라이브러리와 인증 모듈을 코드 스플리팅한다.

### 11.4 잠재적 도전 과제

| 도전 과제 | 영향 | 완화 전략 |
|-----------|------|-----------|
| Binance API 접근 제한 (지역 차단) | 한국 등 일부 국가에서 Binance API 접근 불가 | Upbit 통합을 Phase 2로 추진, VPN 환경에서의 동작 안내 |
| WebSocket 연결 불안정 (모바일/저사양 네트워크) | 데이터 누락, 사용자 경험 저하 | 지수 백오프 재연결, 재연결 시 스냅샷 재요청으로 데이터 정합성 복구 |
| Canvas 접근성 한계 | 스크린 리더가 Canvas 내용을 읽지 못함 | ARIA 레이블, 숨겨진 DOM 텍스트로 핵심 수치 제공 |
| 장시간 운용 시 메모리 증가 | 4시간 이상 사용 시 잠재적 성능 저하 | 링 버퍼, Typed Array, 주기적 데이터 정리, `performance.measureUserAgentSpecificMemory()` 모니터링 |
| Binance API 스펙 변경 | 기존 데이터 파이프라인 작동 중단 | API 응답 스키마 유효성 검증 레이어 추가, 에러 바운더리 적용 |

## 12. 비기능 요구사항

### 12.1 접근성 (Accessibility)

- WCAG 2.1 AA 수준을 목표로 한다.
- 모든 인터랙티브 요소(버튼, 드롭다운, 탭)에 키보드 접근성을 보장한다.
- Canvas 기반 위젯(오더북, 체결 내역)은 `aria-label`과 숨겨진 텍스트 요소로 현재 최고 호가/최근 체결가를 스크린 리더에 전달한다.
- 색각 이상 사용자를 위해 색상 외에 아이콘/텍스트로도 매수/매도를 구분할 수 있도록 한다.
- 포커스 표시(focus ring)가 모든 인터랙티브 요소에서 시각적으로 명확하게 보여야 한다.

### 12.2 브라우저 지원

| 브라우저 | 최소 버전 | 비고 |
|----------|-----------|------|
| Chrome | 최신 2개 메이저 버전 | 주요 대상 브라우저 |
| Firefox | 최신 2개 메이저 버전 | |
| Safari | 최신 2개 메이저 버전 | WebSocket, Canvas API 호환성 확인 필요 |
| Edge | 최신 2개 메이저 버전 | Chromium 기반 |
| IE | 미지원 | |

### 12.3 반응형 디자인

| 브레이크포인트 | 화면 너비 | 레이아웃 전략 |
|---------------|-----------|--------------|
| Desktop (lg) | >= 1200px | 12컬럼 그리드, 모든 위젯 동시 표시 |
| Tablet (md) | 996px ~ 1199px | 6컬럼 그리드, 위젯 자동 재배치 |
| Mobile (sm) | 768px ~ 995px | 단일 컬럼, 위젯 세로 스택 |
| Mobile (xs) | < 768px | 단일 컬럼, 간소화된 위젯 (오더북 깊이 축소 등) |

### 12.4 에러 처리

- 모든 WebSocket 에러는 사용자에게 비침입적 토스트 알림으로 표시한다.
- API 요청 실패 시 최대 3회 재시도 후 에러 상태를 표시한다.
- React Error Boundary를 위젯 단위로 적용하여, 하나의 위젯 오류가 전체 대시보드를 크래시시키지 않도록 한다.
- 네트워크 단절 시 오프라인 배너를 표시하고, 재연결 시 자동으로 사라진다.

## 13. 확장 계획

### 13.1 Phase 1 - 핵심 기능 (MVP)

**기간**: 4주 (1인 개발 기준)

- Binance WebSocket 연동 (캔들, 오더북, 체결 내역)
- Canvas 기반 오더북 및 체결 내역 렌더링
- TradingView Lightweight Charts 캔들스틱 차트
- React Grid Layout 기반 드래그 앤 드롭 대시보드
- 관심 종목 (localStorage 저장)
- 다크 모드 기본 UI
- Vercel 배포

### 13.2 Phase 2 - 사용자 인증 및 영속화

**기간**: 2주

- Supabase 소셜 로그인 (Google, GitHub)
- 레이아웃 및 관심 종목 클라우드 저장/복원
- 사용자 설정 (테마, 오더북 깊이, 기본 타임프레임)

### 13.3 Phase 3 - 업비트 통합 및 고급 기능

**기간**: 3주

- Upbit WebSocket API 통합 (KRW 마켓)
- 거래소 간 가격 비교 위젯 (김치 프리미엄)
- 가격 알림 (브라우저 Notification API)
- 미니 차트 (관심 종목 내 스파크라인)

### 13.4 Phase 4 - 최적화 및 고도화

**기간**: 2주

- Web Worker를 활용한 데이터 파싱 오프로딩
- SharedArrayBuffer를 이용한 메인 스레드-워커 간 제로카피 데이터 전달 (환경 지원 시)
- PWA 지원 (오프라인 셸, 앱 설치)
- 성능 대시보드 (사용자에게 현재 fps, 메모리 사용량 표시)

## 14. 마일스톤 및 일정

### 14.1 프로젝트 규모 추정

| 항목 | 추정 |
|------|------|
| 총 개발 기간 | 11주 (1인 풀타임 기준) |
| 팀 규모 | 1인 (풀스택 프론트엔드 개발자) |
| 총 작업량 | 약 440시간 |

### 14.2 상세 일정

| 마일스톤 | 기간 | 주요 산출물 | 완료 기준 |
|----------|------|-------------|-----------|
| M0: 프로젝트 셋업 | 1주차 | 개발 환경, CI/CD, 디자인 시스템 기초 | Next.js 프로젝트 구동, Vercel 배포 파이프라인 동작, ESLint/Prettier 설정 완료 |
| M1: 데이터 레이어 | 2~3주차 | WebSocket 매니저, Zustand 스토어, REST 히스토리 fetch | 바이낸스 WebSocket에서 3종 데이터(kline, depth, trade) 수신 및 상태 반영 확인 |
| M2: 차트 및 렌더링 | 4~5주차 | Lightweight Charts 통합, Canvas 오더북/체결 렌더러 | 실시간 데이터가 60fps로 렌더링되는 것을 DevTools에서 확인 |
| M3: 대시보드 그리드 | 6주차 | React Grid Layout, 위젯 시스템, 레이아웃 저장 | 드래그/리사이즈/추가/삭제 동작 및 localStorage 저장 확인 |
| M4: 인증 및 영속화 | 7~8주차 | Supabase Auth, DB 스키마, 클라우드 저장 | 로그인 → 레이아웃 저장 → 다른 기기에서 복원 시나리오 동작 확인 |
| M5: 업비트 통합 | 9주차 | Upbit WebSocket 연동, 거래소 전환 UI | Upbit KRW 마켓 데이터 표시 및 거래소 간 전환 동작 확인 |
| M6: 최적화 및 QA | 10~11주차 | 성능 최적화, 메모리 프로파일링, E2E 테스트 | 성능 목표(5.1~5.4) 전체 충족, 1시간 연속 사용 테스트 통과 |

## 15. 제약 사항 및 리스크

### 15.1 기술적 제약

| 제약 사항 | 설명 | 대응 방안 |
|-----------|------|-----------|
| Binance 지역 제한 | 한국 IP에서 Binance API 접근이 제한될 수 있음 | VPN 사용 안내 + Phase 3에서 Upbit 통합으로 대체 경로 확보 |
| 퍼블릭 API 한계 | Rate limit, 데이터 지연, 스펙 변경 가능성 | 에러 핸들링 강화, 스키마 검증, 재시도 로직 |
| 브라우저 WebSocket 제한 | 브라우저 당 동시 WebSocket 연결 수 제한 (일반적으로 6~256개) | Combined Stream 활용으로 연결 수 최소화 (1~2개) |
| Canvas 접근성 | Canvas 내부 콘텐츠를 스크린 리더가 읽지 못함 | ARIA 대체 텍스트, 숨겨진 DOM 보조 요소 |
| localStorage 용량 | 5MB 제한 | 레이아웃 프리셋 5개 이하로 제한, 로그인 유도 |

### 15.2 프로젝트 리스크

| 리스크 | 확률 | 영향도 | 완화 전략 |
|--------|------|--------|-----------|
| Binance API 스펙 변경 또는 서비스 중단 | 낮음 | 높음 | API 응답 타입을 인터페이스로 정의하고 런타임 유효성 검증 적용. Upbit를 대체 데이터 소스로 확보 |
| Canvas 렌더링 성능이 기대에 미치지 못함 | 낮음 | 중간 | 프로토타입 단계에서 10만 건/초 수준 부하 테스트를 선행하여 검증. 필요 시 OffscreenCanvas 또는 WebGL 전환 |
| React Grid Layout 리사이즈 시 Canvas 깨짐 | 중간 | 중간 | ResizeObserver로 감지 후 Canvas 크기 재설정, 디바운스 적용 |
| 장시간 사용 시 예상치 못한 메모리 누수 | 중간 | 높음 | CI에서 Puppeteer 기반 4시간 운용 테스트 자동화, Memory 프로파일링 리포트 생성 |
| Supabase 무료 티어 제한 초과 | 낮음 | 낮음 | 무료 티어 한도 모니터링, 필요 시 Pro 전환 또는 자체 PostgreSQL 마이그레이션 |

## 16. 사용자 스토리

### US-001: 실시간 캔들스틱 차트 조회

**설명**: 트레이더로서, 선택한 암호화폐의 실시간 캔들스틱 차트를 확인하여 가격 추세를 분석하고 싶다.

**인수 조건**:
- 대시보드 접속 시 BTC/USDT 1분봉 캔들스틱 차트가 기본으로 표시된다.
- 과거 500개 캔들이 초기 로딩되며, 이후 실시간으로 새 캔들이 추가된다.
- 미완성 캔들은 실시간으로 업데이트되며, 캔들이 마감되면 확정된 캔들로 전환된다.
- 차트에 마우스를 올리면 십자선과 함께 해당 위치의 OHLCV 정보가 표시된다.
- 마우스 휠로 줌, 드래그로 패닝이 가능하다.

### US-002: 차트 타임프레임 변경

**설명**: 트레이더로서, 캔들스틱 차트의 타임프레임을 변경하여 다양한 시간대의 가격 흐름을 분석하고 싶다.

**인수 조건**:
- 차트 위젯 상단에 1m, 5m, 15m, 1h, 4h, 1d 타임프레임 선택 버튼이 제공된다.
- 타임프레임 변경 시 해당 타임프레임의 과거 500개 캔들이 새로 로딩된다.
- 변경 중 로딩 상태가 표시되며, 기존 차트가 갑자기 사라지지 않는다.
- 현재 선택된 타임프레임 버튼이 시각적으로 활성 상태임을 표시한다.

### US-003: 심볼(종목) 변경

**설명**: 트레이더로서, 다른 암호화폐의 데이터를 보기 위해 심볼을 변경하고 싶다.

**인수 조건**:
- 대시보드 상단 또는 위젯 내에 심볼 검색/선택 UI가 제공된다.
- 심볼 검색 시 실시간으로 필터링되며, USDT 마켓 기준으로 정렬된다.
- 심볼 선택 시 차트, 오더북, 체결 내역 위젯이 모두 해당 종목 데이터로 전환된다.
- 전환 시 기존 WebSocket 스트림이 해제되고 새 스트림으로 구독이 시작된다.
- 전환 완료까지 2초 이내에 새 종목 데이터가 표시된다.

### US-004: 실시간 오더북 조회

**설명**: 트레이더로서, 선택한 종목의 실시간 호가 데이터를 확인하여 시장의 매수/매도 압력을 파악하고 싶다.

**인수 조건**:
- 오더북 위젯에 매수(녹색)와 매도(빨간색) 호가가 가격 기준으로 정렬되어 표시된다.
- 각 호가에 가격, 수량, 누적 수량이 표시된다.
- 각 호가 행 뒤에 수량 비율을 나타내는 깊이 바(depth bar)가 렌더링된다.
- 데이터는 100ms 주기로 업데이트되며, Canvas에서 60fps로 렌더링된다.
- 가격이 변동된 행에 짧은 하이라이트 애니메이션이 적용된다.

### US-005: 오더북 깊이 수준 변경

**설명**: 트레이더로서, 오더북에 표시되는 호가 깊이를 조절하여 원하는 수준의 시장 정보를 확인하고 싶다.

**인수 조건**:
- 오더북 위젯 상단에 10/25/50 깊이 선택 드롭다운이 제공된다.
- 깊이 변경 시 즉시 표시 행 수가 변경된다.
- 변경 후에도 Canvas 렌더링이 매끄럽게 유지된다.
- 선택된 깊이 값이 localStorage(비로그인) 또는 Supabase(로그인)에 저장되어 재방문 시 복원된다.

### US-006: 실시간 체결 내역 조회

**설명**: 트레이더로서, 선택한 종목의 실시간 체결 내역을 확인하여 시장 활동을 모니터링하고 싶다.

**인수 조건**:
- 체결 내역 위젯에 최근 200건의 체결이 최신순으로 표시된다.
- 각 체결 건에 시간, 가격, 수량이 표시된다.
- 매수 체결은 녹색, 매도 체결은 빨간색으로 색상 구분된다.
- 새 체결이 발생하면 상단에 추가되며, 오래된 항목은 하단에서 자동 제거된다.
- Canvas 기반 렌더링으로 60fps가 유지된다.

### US-007: 위젯 드래그 앤 드롭 이동

**설명**: 사용자로서, 대시보드의 위젯을 드래그하여 원하는 위치로 이동시켜 나만의 레이아웃을 구성하고 싶다.

**인수 조건**:
- 각 위젯의 헤더 영역을 마우스로 드래그하면 위젯이 이동한다.
- 드래그 중 다른 위젯들이 자동으로 자리를 비켜주며 재배치된다.
- 드롭 후 위젯이 그리드에 스냅되어 정렬된다.
- 레이아웃 변경이 자동으로 저장된다 (비로그인: localStorage, 로그인: Supabase).
- 드래그 중 Canvas 위젯의 렌더링이 중단되거나 깨지지 않는다.

### US-008: 위젯 리사이즈

**설명**: 사용자로서, 위젯의 크기를 조절하여 중요한 정보에 더 넓은 공간을 할당하고 싶다.

**인수 조건**:
- 각 위젯의 우측 하단에 리사이즈 핸들이 표시된다.
- 리사이즈 핸들을 드래그하면 위젯 크기가 변경된다.
- 차트 위젯은 리사이즈에 따라 Canvas 크기가 자동 재조정된다.
- 오더북/체결 위젯은 리사이즈에 따라 표시 행 수가 자동 조정된다.
- 최소 크기 제한이 적용되어 위젯 내용이 읽을 수 없을 정도로 작아지지 않는다.

### US-009: 위젯 추가

**설명**: 사용자로서, 대시보드에 새로운 위젯을 추가하여 더 많은 정보를 한 화면에서 모니터링하고 싶다.

**인수 조건**:
- 대시보드 상단 툴바에 "+" 버튼이 있으며, 클릭하면 추가 가능한 위젯 목록이 표시된다.
- 위젯 종류 선택 시 기본 크기로 대시보드에 추가된다.
- 새로 추가된 위젯은 빈 공간에 자동 배치되거나, 기존 위젯 하단에 추가된다.
- 동일 종류의 위젯을 여러 개 추가할 수 있다 (예: 서로 다른 심볼의 차트 2개).
- 추가 즉시 해당 위젯의 WebSocket 스트림 구독이 시작된다.

### US-010: 위젯 제거

**설명**: 사용자로서, 불필요한 위젯을 제거하여 대시보드를 정리하고 싶다.

**인수 조건**:
- 각 위젯의 우측 상단에 닫기(x) 버튼이 있다.
- 닫기 버튼 클릭 시 확인 없이 즉시 위젯이 제거된다.
- 위젯 제거 시 해당 위젯이 사용하던 WebSocket 구독이 해제되고, Chart/Canvas 인스턴스가 정리된다.
- 나머지 위젯들이 빈 공간을 채우도록 자동 재배치된다.
- 레이아웃 변경이 저장된다.

### US-011: 레이아웃 초기화

**설명**: 사용자로서, 커스텀한 레이아웃을 기본 상태로 되돌리고 싶다.

**인수 조건**:
- 대시보드 상단 툴바에 "레이아웃 리셋" 버튼이 있다.
- 클릭 시 확인 대화상자가 표시된다 ("기본 레이아웃으로 복원하시겠습니까?").
- 확인 시 기본 레이아웃(BTC/USDT 차트 + 오더북 + 체결 내역 + 관심 종목)으로 복원된다.
- 기존 WebSocket 구독이 정리되고 기본 심볼의 스트림으로 재구독된다.

### US-012: 관심 종목 추가

**설명**: 트레이더로서, 자주 모니터링하는 종목을 관심 목록에 추가하여 빠르게 접근하고 싶다.

**인수 조건**:
- 관심 종목 위젯에 검색 입력 필드가 있다.
- 종목 이름 또는 심볼로 검색하면 자동완성 목록이 표시된다.
- 검색 결과에서 종목을 클릭하면 관심 목록에 추가된다.
- 최대 20개까지 추가 가능하며, 초과 시 안내 메시지가 표시된다.
- 추가 즉시 해당 종목의 실시간 가격과 변동률이 표시되기 시작한다.

### US-013: 관심 종목 제거

**설명**: 트레이더로서, 더 이상 모니터링하지 않는 종목을 관심 목록에서 제거하고 싶다.

**인수 조건**:
- 각 관심 종목 행에 마우스 호버 시 삭제 아이콘이 표시된다.
- 삭제 아이콘 클릭 시 해당 종목이 목록에서 즉시 제거된다.
- 해당 종목의 miniTicker WebSocket 구독이 해제된다.
- 관심 종목 목록 변경이 즉시 저장된다.

### US-014: 관심 종목 클릭으로 심볼 전환

**설명**: 트레이더로서, 관심 종목 목록에서 종목을 클릭하여 대시보드 전체를 해당 종목 데이터로 전환하고 싶다.

**인수 조건**:
- 관심 종목 위젯의 종목 행을 클릭하면 차트, 오더북, 체결 내역 위젯이 해당 종목으로 전환된다.
- 현재 선택된 종목이 관심 목록에서 시각적으로 하이라이트된다.
- 전환 시 2초 이내에 모든 위젯이 새 종목 데이터를 표시한다.

### US-015: 소셜 로그인 (Google)

**설명**: 사용자로서, Google 계정으로 간편하게 로그인하여 대시보드 설정을 저장하고 싶다.

**인수 조건**:
- 우측 상단의 로그인 버튼을 클릭하면 Google/GitHub 로그인 옵션이 표시된다.
- Google 로그인 선택 시 Google OAuth 흐름이 진행된다.
- 로그인 성공 시 프로필 아이콘과 사용자 이름이 상단에 표시된다.
- 로그인 시 localStorage에 저장된 레이아웃/관심 종목을 Supabase로 마이그레이션할지 확인한다.
- 로그인 과정에서 실시간 데이터 스트리밍이 중단되지 않는다.

### US-016: 소셜 로그인 (GitHub)

**설명**: 사용자로서, GitHub 계정으로 간편하게 로그인하여 대시보드 설정을 저장하고 싶다.

**인수 조건**:
- GitHub 로그인 선택 시 GitHub OAuth 흐름이 진행된다.
- 로그인 성공 시 프로필 아이콘과 사용자 이름이 상단에 표시된다.
- GitHub 프로필 아바타가 표시된다.
- 로그인 후 동작은 US-015와 동일하다.

### US-017: 로그아웃

**설명**: 로그인 사용자로서, 안전하게 로그아웃하고 싶다.

**인수 조건**:
- 프로필 아이콘 클릭 시 드롭다운에 로그아웃 옵션이 표시된다.
- 로그아웃 시 Supabase 세션이 종료된다.
- 로그아웃 후에도 대시보드의 모든 실시간 기능은 계속 동작한다.
- 레이아웃과 관심 종목은 localStorage 기반으로 전환된다.
- 로그아웃 과정에서 데이터 스트리밍이 중단되지 않는다.

### US-018: 비로그인 상태에서 핵심 기능 사용

**설명**: 비로그인 사용자로서, 로그인 없이도 모든 실시간 데이터와 차트를 사용하고 싶다.

**인수 조건**:
- 대시보드 접속 시 로그인을 요구하지 않는다.
- 캔들스틱 차트, 오더북, 체결 내역, 심볼 변경 등 모든 데이터 기능이 동작한다.
- 위젯 드래그/리사이즈/추가/제거가 가능하다.
- 레이아웃과 관심 종목이 localStorage에 저장되어 새로고침 후에도 복원된다.
- 로그인을 유도하는 배너가 비침입적으로 표시된다 (예: "로그인하면 다른 기기에서도 레이아웃을 사용할 수 있습니다").

### US-019: 저장된 레이아웃 클라우드 복원

**설명**: 로그인 사용자로서, 다른 기기에서 접속해도 이전에 저장한 레이아웃이 복원되기를 원한다.

**인수 조건**:
- 로그인 시 Supabase에 저장된 마지막 레이아웃이 자동으로 적용된다.
- 레이아웃에는 위젯 종류, 위치, 크기, 각 위젯의 심볼 설정이 포함된다.
- 레이아웃 변경 시 500ms debounce 후 자동으로 Supabase에 저장된다.
- 네트워크 오류로 저장 실패 시 로컬에 백업하고, 다음 연결 시 재시도한다.

### US-020: WebSocket 연결 끊김 시 자동 재연결

**설명**: 사용자로서, 네트워크 불안정으로 연결이 끊어져도 자동으로 재연결되어 데이터 수신이 재개되기를 원한다.

**인수 조건**:
- WebSocket 연결 끊김 시 3초 이내에 재연결을 시도한다.
- 재연결 중 상단 바에 "재연결 중..." 상태가 노란색 아이콘으로 표시된다.
- 재연결 시 지수 백오프가 적용된다 (1초 → 2초 → 4초 → ... → 최대 30초).
- 재연결 성공 시 오더북 스냅샷을 재요청하여 데이터 정합성을 복구한다.
- 재연결 성공 시 상태 아이콘이 녹색으로 변경되고 정상 동작이 재개된다.
- 최대 재시도 횟수(10회) 초과 시 "연결 실패" 상태를 표시하고 수동 재연결 버튼을 제공한다.

### US-021: 연결 상태 표시

**설명**: 사용자로서, 현재 WebSocket 연결 상태를 한눈에 확인하고 싶다.

**인수 조건**:
- 대시보드 상단에 연결 상태 인디케이터가 항상 표시된다.
- 연결됨: 녹색 원형 아이콘 + "연결됨" 텍스트
- 재연결 중: 노란색 깜빡이는 아이콘 + "재연결 중..." 텍스트
- 연결 끊김: 빨간색 아이콘 + "연결 끊김" 텍스트 + 수동 재연결 버튼
- 상태 변경 시 비침입적 토스트 알림이 표시된다.

### US-022: 다크/라이트 테마 전환

**설명**: 사용자로서, 사용 환경에 맞게 다크 모드와 라이트 모드를 전환하고 싶다.

**인수 조건**:
- 대시보드 상단에 테마 토글 버튼이 있다.
- 기본값은 다크 모드이다.
- 테마 전환 시 모든 위젯(차트, 오더북, 체결 내역 포함)이 일괄 변경된다.
- Lightweight Charts의 테마도 함께 전환된다.
- 선택한 테마가 저장되어 재방문 시 적용된다.
- 전환 시 전체 페이지 깜빡임(FOUC)이 없어야 한다.

### US-023: 반응형 레이아웃 자동 전환

**설명**: 사용자로서, 다양한 화면 크기에서도 대시보드가 적절하게 표시되기를 원한다.

**인수 조건**:
- Desktop(>=1200px): 12컬럼 그리드, 모든 위젯 자유 배치
- Tablet(996~1199px): 6컬럼 그리드, 위젯 자동 재배치
- Mobile(768~995px): 단일 컬럼, 위젯 세로 스택
- 화면 크기 변경 시 레이아웃이 자연스럽게 전환된다.
- Canvas 기반 위젯이 새 크기에 맞게 재렌더링된다.

### US-024: URL로 특정 종목 대시보드 직접 접근

**설명**: 사용자로서, URL에 종목 코드를 포함하여 특정 종목의 대시보드에 직접 접근하고 싶다.

**인수 조건**:
- `?symbol=ETHUSDT` 형식의 쿼리 파라미터를 지원한다.
- 유효한 심볼 파라미터가 있으면 해당 종목으로 대시보드가 초기화된다.
- 유효하지 않은 심볼인 경우 기본값(BTCUSDT)으로 폴백하고 경고 메시지를 표시한다.
- 심볼 변경 시 URL 쿼리 파라미터가 자동으로 업데이트되어, URL 공유 시 동일한 종목 화면을 재현할 수 있다.

### US-025: 장시간 사용 시 안정적 메모리 관리

**설명**: 트레이더로서, 대시보드를 몇 시간 동안 켜놓아도 느려지거나 크래시되지 않기를 원한다.

**인수 조건**:
- 1시간 연속 사용 후 JS Heap 메모리가 200MB를 초과하지 않는다.
- Detached DOM Node가 0개이다.
- 체결 내역은 링 버퍼(200건)로 관리되어 무한정 증가하지 않는다.
- 캔들 데이터는 2,000개로 제한되어 오래된 데이터가 자동 정리된다.
- 4시간 연속 사용 시에도 프레임 드롭율 1% 미만을 유지한다.

### US-026: 비활성 탭에서의 리소스 절약

**설명**: 사용자로서, 대시보드 탭이 비활성 상태일 때 CPU/메모리 사용량이 감소하기를 원한다.

**인수 조건**:
- 탭이 비활성화(document.hidden === true)되면 Canvas 렌더링 루프가 중단된다.
- WebSocket 연결은 유지되며 데이터는 계속 수신/버퍼링된다.
- 탭이 다시 활성화되면 오더북 스냅샷을 재요청하여 데이터 정합성을 보장한다.
- 렌더링이 즉시 재개되어 최신 데이터가 표시된다.
- 비활성 상태에서 CPU 사용률이 유의미하게 감소한다.

### US-027: 개별 위젯 에러 격리

**설명**: 사용자로서, 하나의 위젯에서 오류가 발생해도 다른 위젯과 전체 대시보드가 정상 동작하기를 원한다.

**인수 조건**:
- 각 위젯이 독립적인 React Error Boundary로 감싸져 있다.
- 위젯 내부에서 렌더링 오류 발생 시 해당 위젯에 에러 메시지와 "다시 시도" 버튼이 표시된다.
- 오류가 발생한 위젯을 제외한 나머지 위젯은 정상 동작을 계속한다.
- "다시 시도" 클릭 시 해당 위젯의 WebSocket 구독부터 렌더링까지 전체 재초기화된다.
- 에러 발생 시 콘솔에 상세 에러 로그가 기록된다.

### US-028: 키보드 접근성

**설명**: 키보드 사용자로서, 마우스 없이도 대시보드의 주요 기능을 사용하고 싶다.

**인수 조건**:
- Tab 키로 모든 인터랙티브 요소(버튼, 드롭다운, 심볼 검색)를 순회할 수 있다.
- Enter/Space로 버튼과 메뉴 항목을 활성화할 수 있다.
- Escape로 열린 드롭다운/모달을 닫을 수 있다.
- 포커스 인디케이터가 시각적으로 명확하게 표시된다.
- 심볼 검색 필드에서 화살표 키로 자동완성 목록을 탐색하고 Enter로 선택할 수 있다.

### US-029: 초기 로딩 성능

**설명**: 사용자로서, 대시보드에 처음 접속했을 때 빠르게 콘텐츠가 표시되기를 원한다.

**인수 조건**:
- FCP(First Contentful Paint)가 1.0초 이내이다.
- LCP(Largest Contentful Paint)가 2.0초 이내이다.
- TTI(Time to Interactive)가 3.0초 이내이다.
- 초기 JS 번들 크기가 gzip 기준 150KB 이하이다.
- 차트 라이브러리는 Dynamic Import로 코드 스플리팅되어 초기 로딩에 포함되지 않는다.
- 로딩 중 스켈레톤 UI가 표시되어 레이아웃 시프트(CLS)가 0.1 이하이다.

### US-030: Retina 디스플레이 선명 렌더링

**설명**: Retina 디스플레이 사용자로서, Canvas 기반 위젯이 선명하게 표시되기를 원한다.

**인수 조건**:
- Canvas 해상도가 `window.devicePixelRatio`를 반영하여 설정된다.
- Retina(2x) 및 고해상도(3x) 디스플레이에서 텍스트와 그래프가 흐릿하지 않다.
- CSS 크기와 Canvas 물리적 크기가 올바르게 매핑되어 클릭/터치 좌표가 정확하다.

### US-031: 오프라인 상태 감지 및 안내

**설명**: 사용자로서, 인터넷 연결이 끊어졌을 때 명확한 안내를 받고 싶다.

**인수 조건**:
- `navigator.onLine` 및 `online`/`offline` 이벤트로 네트워크 상태를 감지한다.
- 오프라인 전환 시 대시보드 상단에 "인터넷 연결이 끊어졌습니다" 배너가 표시된다.
- 마지막으로 수신한 데이터는 그대로 표시되어 사용자가 최근 상태를 참조할 수 있다.
- 온라인 복귀 시 배너가 자동으로 사라지고 데이터 스트리밍이 재개된다.

### US-032: 관심 종목 실시간 가격 및 변동률 표시

**설명**: 트레이더로서, 관심 종목 목록에서 각 종목의 현재 가격과 24시간 변동률을 실시간으로 확인하고 싶다.

**인수 조건**:
- 각 관심 종목 행에 종목명, 현재 가격, 24시간 변동률(%)이 표시된다.
- 가격과 변동률은 Binance `miniTicker` 스트림을 통해 실시간 업데이트된다.
- 변동률이 양수면 녹색, 음수면 빨간색으로 표시된다.
- 가격 변동 시 짧은 플래시 애니메이션으로 변화를 시각적으로 강조한다.
